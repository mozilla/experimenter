{# templates/nimbus_experiments/preview_success.html #}
<div class="alert alert-success bg-transparent text-success">
    <p class="my-1">
        <svg class="align-top" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" width="16" height="16">
            <path d="M13.485 1.4a.5.5 0 0 1 .035.71L6.543 9.793 3.379 6.93a.5.5 0 1 1 .708-.707l2.1 2.1 6.514-7.1a.5.5 0 0 1 .707-.035z"/>
        </svg>
        All set! Your experiment is in Preview mode and you can test it now.
    </p>
</div>

<div class="alert alert-secondary">
    <form method="post" action="{% url 'launch-preview-to-review' slug=experiment.slug %}" hx-post="{% url 'launch-preview-to-review' slug=experiment.slug %}" hx-target="#launch-controls" hx-swap="outerHTML" id="preview-controls-form">
        {% csrf_token %}
        <p class="my-1">
            This experiment is currently <strong>live for testing</strong>, but you will need to let QA know in your 
            <a href="https://example.com/qa-pi-doc" target="_blank">PI request</a>. When you have received a sign-off, click “Request Launch” to launch the experiment.
            <strong>Note: It can take up to an hour before clients receive a preview experiment.</strong>
        </p>

        <!-- Confirmation Checkboxes -->
        <div class="form-check">
            <input type="checkbox" class="form-check-input" id="checkbox-1" onchange="toggleSubmitButton()">
            <label class="form-check-label" for="checkbox-1">Checkbox 1</label>
        </div>
        <div class="form-check">
            <input type="checkbox" class="form-check-input" id="checkbox-2" onchange="toggleSubmitButton()">
            <label class="form-check-label" for="checkbox-2">Checkbox 2</label>
        </div>

        <!-- Action Buttons -->
        <div class="d-flex bd-highlight py-2">
            <button type="submit" class="btn btn-primary mr-3" id="request-launch-button" hx-post="{% url 'launch-preview-to-review' slug=experiment.slug %}"
                hx-target="#experiment-container"
                hx-swap="innerHTML"disabled>
                Request Launch
            </button>
            <button
                type="button"
                class="btn btn-secondary"
                hx-post="{% url 'launch-preview-to-draft' slug=experiment.slug %}"
                hx-target="#experiment-container"
                hx-swap="innerHTML">
                Go Back to Draft
            </button>
        </div>
    </form>
</div>

<script>
    function toggleSubmitButton() {
        const checkboxes = document.querySelectorAll(".form-check-input");
        const submitButton = document.getElementById("request-launch-button");
        const allChecked = Array.from(checkboxes).every(checkbox => checkbox.checked);
        submitButton.disabled = !allChecked;
    }
</script>
