# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at https://mozilla.org/MPL/2.0/.
---
fenix:
  slug: "fenix"
  repo:
    type: "github"
    name: "mozilla-mobile/firefox-android"
  fml_path: "fenix/app/nimbus.fml.yaml"
  release_discovery:
    version_file:
      type: "plaintext"
      path: "version.txt"
    strategies:
      - type: "tagged"
        branch_re: 'releases_v(?P<major>\d+)'
        tag_re: 'fenix-v(?P<major>\d+)\.(?P<minor>\d+)(?:\.(?P<patch>\d+))?'

firefox_ios:
  slug: "ios"
  repo:
    type: "github"
    name: "mozilla-mobile/firefox-ios"
  fml_path: "nimbus.fml.yaml"
  release_discovery:
    version_file:
      type: "plist"
      path: "Client/Info.plist"
      key: "CFBundleShortVersionString"
    strategies:
      - type: "tagged"
        branch_re: 'release/v(?P<major>\d+)(?:\.(?P<minor>\d+))?'
        tag_re: 'v(?P<major>\d+)\.(?P<minor>\d+)'

focus_android:
  slug: "focus-android"
  repo:
    type: "github"
    name: "mozilla-mobile/firefox-android"
  fml_path: "focus-android/app/nimbus.fml.yaml"
  release_discovery:
    version_file:
      type: "plaintext"
      path: "version.txt"
    strategies:
      - type: "tagged"
        branch_re: 'releases_v(?P<major>\d+)'
        tag_re: 'focus-v(?P<major>\d+)\.(?P<minor>\d+)(?:\.(?P<patch>\d+))?'

focus_ios:
  slug: "focus-ios"
  repo:
    type: "github"
    name: "mozilla-mobile/focus-ios"
  fml_path: "nimbus.fml.yaml"
  release_discovery:
    version_file:
      type: "plist"
      path: "Blockzilla/Info.plist"
      key: "CFBundleShortVersionString"
    strategies:
      - type: "tagged"
        branch_re: 'releases_v(?P<major>\d+)(?:\.(?P<minor>\d+))?'
        tag_re: 'v(?P<major>\d+)\.(?P<minor>\d+)(?:\.(?P<patch>\d+))?'
        ignored_branches:
          - "releases_v999" # nimbus.fml.yaml missing. Breaks "last 5 releases" logic.
        ignored_tags:
          - "v999.0.0" # nimbus.fml.yaml missing.

monitor_cirrus:
  slug: "monitor-web"
  repo:
    type: "github"
    name: "mozilla/blurts-server"
  fml_path: "config/nimbus.yaml"

firefox_desktop:
  slug: "firefox-desktop"
  repo:
    type: "hgmo"
    name: "mozilla-central"
  experimenter_yaml_path: "toolkit/components/nimbus/FeatureManifest.yaml"
