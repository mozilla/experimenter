# Generated by Django 5.2.9 on 2026-01-21 18:07

from django.db import migrations


def unset_preview_publish_status(apps, schema_editor):
    NimbusExperiment = apps.get_model("experiments", "NimbusExperiment")
    invalid_experiments = NimbusExperiment.objects.filter(publish_status="Preview")
    invalid_experiments.update(
        status="Draft",
        status_next=None,
        publish_status="Idle",
    )

class Migration(migrations.Migration):

    dependencies = [
        ('experiments', '0315_results_v3_overall_dict'),
    ]

    operations = [
        migrations.RunPython(
            unset_preview_publish_status,
            reverse_code=migrations.RunPython.noop,
        ),
    ]
