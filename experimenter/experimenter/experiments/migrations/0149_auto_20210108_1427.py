# Generated by Django 3.1.5 on 2021-01-08 14:27

import django.core.validators
import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


def set_owner(apps, schema_editor):
    User = apps.get_model("auth", "User")
    NimbusExperiment = apps.get_model("experiments", "NimbusExperiment")
    db_alias = schema_editor.connection.alias
    if NimbusExperiment.objects.exists():
        dummy_user = "nobody@example.com"
        user, _ = User.objects.get_or_create(
            email=dummy_user, username=dummy_user, first_name="no", last_name="body"
        )
        NimbusExperiment.objects.using(db_alias).filter(owner=None).update(owner=user)


class Migration(migrations.Migration):
    atomic = False

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ("experiments", "0148_auto_20201216_1815"),
    ]

    operations = [
        migrations.RunPython(set_owner),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="application",
            field=models.CharField(
                choices=[("firefox-desktop", "Desktop"), ("fenix", "Fenix")],
                default="firefox-desktop",
                max_length=255,
            ),
            preserve_default=False,
        ),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="channel",
            field=models.CharField(
                choices=[
                    ("", "No Channel"),
                    ("beta", "Desktop Beta"),
                    ("nightly", "Desktop Nightly"),
                    ("release", "Desktop Release"),
                    ("default", "Desktop Unbranded"),
                    ("org.mozilla.firefox.beta", "Fenix Beta"),
                    ("org.mozilla.fenix", "Fenix Nightly"),
                    ("org.mozilla.firefox", "Fenix Release"),
                ],
                default="",
                max_length=255,
            ),
        ),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="firefox_min_version",
            field=models.CharField(
                choices=[
                    ("", "No Version"),
                    ("80.!", "Firefox 80"),
                    ("81.!", "Firefox 81"),
                    ("82.!", "Firefox 82"),
                    ("83.!", "Firefox 83"),
                    ("84.!", "Firefox 84"),
                    ("85.!", "Firefox 85"),
                    ("86.!", "Firefox 86"),
                    ("87.!", "Firefox 87"),
                    ("88.!", "Firefox 88"),
                    ("89.!", "Firefox 89"),
                    ("90.!", "Firefox 90"),
                    ("91.!", "Firefox 91"),
                    ("92.!", "Firefox 92"),
                    ("93.!", "Firefox 93"),
                    ("94.!", "Firefox 94"),
                    ("95.!", "Firefox 95"),
                    ("96.!", "Firefox 96"),
                    ("97.!", "Firefox 97"),
                    ("98.!", "Firefox 98"),
                    ("99.!", "Firefox 99"),
                    ("100.!", "Firefox 100"),
                ],
                default="",
                max_length=255,
            ),
        ),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="hypothesis",
            field=models.TextField(
                default="If we <do this/build this/create this change in the experiment> for <these users>, then we will see <this outcome>.\nWe believe this because we have observed <this> via <data source, UR, survey>.\n\nOptional - We believe this outcome will <describe impact> on <core metric>\n    "
            ),
        ),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="owner",
            field=models.ForeignKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="owned_nimbusexperiments",
                to="auth.user",
            ),
        ),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="proposed_duration",
            field=models.PositiveIntegerField(
                default=28, validators=[django.core.validators.MaxValueValidator(1000)]
            ),
        ),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="proposed_enrollment",
            field=models.PositiveIntegerField(
                default=7, validators=[django.core.validators.MaxValueValidator(1000)]
            ),
        ),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="public_description",
            field=models.TextField(default=""),
        ),
        migrations.AlterField(
            model_name="nimbusexperiment",
            name="targeting_config_slug",
            field=models.CharField(
                choices=[
                    ("", "No Targeting"),
                    ("all_english", "All English"),
                    ("us_only", "Us Only"),
                    ("first_run", "Targeting First Run"),
                    ("first_run_chrome", "Targeting First Run Chrome Attribution"),
                    ("homepage_google_dot_com", "Targeting Homepage Google"),
                ],
                default="",
                max_length=255,
            ),
        ),
    ]
