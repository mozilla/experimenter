# Generated by Django 5.2.2 on 2025-08-20 15:50

from django.db import migrations


def add_desktop_channel(apps, schema_editor):
    NimbusExperiment = apps.get_model("experiments", "NimbusExperiment")
    for experiment in NimbusExperiment.objects.filter(application="firefox-desktop"):
        if experiment.channel:
            experiment.channels = [experiment.channel]

        elif experiment.status in ["Live", "Complete"]:
            experiment.channels = [
                "default",
                "nightly",
                "beta",
                "release",
                "esr",
                "aurora",
            ]

        experiment.channel = ""
        experiment.save()


class Migration(migrations.Migration):
    dependencies = [
        (
            "experiments",
            "0290_draft_published_dto_to_none",
        ),
    ]

    operations = [
        migrations.RunPython(add_desktop_channel),
    ]
