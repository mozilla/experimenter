# Generated by Django 2.1.2 on 2019-02-01 18:20

import django.core.validators
from django.db import migrations, models


def limit_durations(apps, schema_editor):  # pragma: nocover
    Experiment = apps.get_model("experiments", "Experiment")

    for experiment in Experiment.objects.all():
        if experiment.proposed_duration:
            experiment.proposed_duration = min(experiment.proposed_duration, 1000)

        if experiment.proposed_enrollment:
            experiment.proposed_enrollment = min(experiment.proposed_enrollment, 1000)

        experiment.save()


class Migration(migrations.Migration):

    dependencies = [("experiments", "0027_auto_20190124_2239")]

    operations = [
        migrations.RunPython(limit_durations, limit_durations),
        migrations.AlterField(
            model_name="experiment",
            name="proposed_duration",
            field=models.PositiveIntegerField(
                blank=True,
                null=True,
                validators=[django.core.validators.MaxValueValidator(1000)],
            ),
        ),
        migrations.AlterField(
            model_name="experiment",
            name="proposed_enrollment",
            field=models.PositiveIntegerField(
                blank=True,
                null=True,
                validators=[django.core.validators.MaxValueValidator(1000)],
            ),
        ),
        migrations.AlterField(
            model_name="experimentcomment",
            name="section",
            field=models.CharField(
                choices=[
                    ("timeline", "Timeline"),
                    ("overview", "Overview"),
                    ("population", "Population"),
                    ("branches", "Firefox & Branches"),
                    ("objectives", "Objectives"),
                    ("analysis", "Analysis"),
                    ("risks", "Risks"),
                    ("testing", "Testing"),
                ],
                max_length=255,
            ),
        ),
    ]
