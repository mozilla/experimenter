{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "title": "V7BaseExperiment",
  "description": "The base experiment definition accessible to both Desktop and SDK experiments.",
  "type": "object",
  "properties": {
    "schemaVersion": {
      "description": "Version of the NimbusExperiment schema.",
      "type": "string"
    },
    "slug": {
      "description": "Unique identifier for the experiment.",
      "type": "string"
    },
    "id": {
      "description": "Unique identifier for the experiment. This is a duplicate of slug.",
      "type": "string"
    },
    "appName": {
      "description": "A slug identifying the targeted product of this experiment.",
      "type": "string"
    },
    "appId": {
      "description": "The platform identifier for the targeted app.",
      "type": "string"
    },
    "channel": {
      "description": "A specific channel of an application such as             'nightly', 'beta', 'release'.",
      "type": "string"
    },
    "userFacingName": {
      "description": "Public name of the experiment displayed in the UI.",
      "type": "string"
    },
    "userFacingDescription": {
      "description": "Short public description of the experiment.",
      "type": "string"
    },
    "isEnrollmentPaused": {
      "description": "Whether new users should be enrolled into the experiment.",
      "type": "boolean"
    },
    "isRollout": {
      "description": "Whether this experiment is a rollout.",
      "type": "boolean"
    },
    "bucketConfig": {
      "$ref": "#/$defs/ExperimentBucketConfig",
      "description": "Bucketing configuration."
    },
    "outcomes": {
      "description": "List of outcomes relevant to analysis.",
      "items": {
        "$ref": "#/$defs/ExperimentOutcome"
      },
      "type": "array"
    },
    "featureIds": {
      "description": "List of featureIds the experiment includes.",
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "targeting": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "A JEXL targeting expression."
    },
    "startDate": {
      "anyOf": [
        {
          "format": "date",
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Actual publish date of the experiment."
    },
    "enrollmentEndDate": {
      "anyOf": [
        {
          "format": "date",
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Actual enrollment end date of the experiment."
    },
    "endDate": {
      "anyOf": [
        {
          "format": "date",
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Actual end date of this experiment."
    },
    "proposedDuration": {
      "description": "Proposed duration of the experiment.",
      "type": "integer"
    },
    "proposedEnrollment": {
      "description": "Number of days expected for new user enrollment.",
      "type": "integer"
    },
    "referenceBranch": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "Slug of the reference branch, if applicable."
    },
    "locales": {
      "anyOf": [
        {
          "items": {
            "type": "string"
          },
          "type": "array"
        },
        {
          "type": "null"
        }
      ],
      "description": "List of targeted locale codes."
    },
    "publishedDate": {
      "anyOf": [
        {
          "format": "date-time",
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "description": "First published date to Remote Settings."
    },
    "localizations": {
      "anyOf": [
        {
          "$ref": "#/$defs/ExperimentLocalizations"
        },
        {
          "type": "null"
        }
      ],
      "description": "Per-locale localization substitutions."
    }
  },
  "required": [
    "schemaVersion",
    "slug",
    "id",
    "appName",
    "appId",
    "channel",
    "userFacingName",
    "userFacingDescription",
    "isEnrollmentPaused",
    "bucketConfig",
    "startDate",
    "endDate",
    "proposedEnrollment",
    "referenceBranch"
  ],
  "$defs": {
    "ExperimentBucketConfig": {
      "description": "Common Bucketing Configuration used across all versions.",
      "properties": {
        "randomizationUnit": {
          "$ref": "#/$defs/RandomizationUnit"
        },
        "namespace": {
          "description": "Additional inputs to the hashing function.",
          "type": "string"
        },
        "start": {
          "description": "Index of the starting bucket of the range.",
          "type": "integer"
        },
        "count": {
          "description": "Number of buckets in the range.",
          "type": "integer"
        },
        "total": {
          "description": "The total number of buckets. You can assume             this will always be 10000.",
          "type": "integer"
        }
      },
      "required": [
        "randomizationUnit",
        "namespace",
        "start",
        "count",
        "total"
      ],
      "type": "object"
    },
    "ExperimentLocalizations": {
      "additionalProperties": {
        "additionalProperties": {
          "type": "string"
        },
        "type": "object"
      },
      "description": "Per-locale localization substitutions. The top level key is the locale (e.g., \"en-US\" or \"fr\"). Each entry is a mapping of string IDs to their localized equivalents.",
      "type": "object"
    },
    "ExperimentOutcome": {
      "properties": {
        "slug": {
          "description": "Identifier for the outcome.",
          "type": "string"
        },
        "priority": {
          "description": "e.g., \"primary\" or \"secondary\".",
          "type": "string"
        }
      },
      "required": [
        "slug",
        "priority"
      ],
      "type": "object"
    },
    "RandomizationUnit": {
      "description": "A unique, stable identifier for the user used as an input to bucket hashing.",
      "enum": [
        "normandy_id",
        "nimbus_id",
        "user_id",
        "group_id"
      ],
      "type": "string"
    }
  }
}
